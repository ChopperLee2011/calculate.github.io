<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­¦ç»ƒä¹ é¢˜</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .problems-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .problem {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .problem:last-child {
            border-bottom: none;
        }
        .problem-number {
            font-weight: bold;
            width: 30px;
        }
        .problem-expression {
            font-size: 18px;
            margin-right: 15px;
        }
        .answer-input {
            width: 80px;
            padding: 8px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        .submit-btn {
            display: block;
            margin: 20px auto;
            padding: 12px 30px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .submit-btn:hover {
            background-color: #45a049;
        }
        .result-container {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        .perfect-score {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        .needs-practice {
            background-color: #fff3e0;
            color: #ef6c00;
        }
        .fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
        }
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
        .note {
            text-align: center;
            color: #666;
            margin: 10px 0;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>æ•°å­¦ç»ƒä¹ é¢˜</h1>
    <div class="note">æ³¨æ„ï¼šé™¤æ³•ç»“æœè¯·ä¿ç•™ä¸€ä½å°æ•°</div>
    <div class="problems-container">
        <div id="problems"></div>
        <button class="submit-btn" onclick="checkAnswers()">æäº¤ç­”æ¡ˆ</button>
    </div>
    <div id="result" class="result-container"></div>
    <canvas id="fireworksCanvas"></canvas>

    <script>
        // ç”Ÿæˆéšæœºæ•°
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // ç”Ÿæˆéšæœºè¿ç®—ç¬¦
        function getRandomOperator() {
            const operators = ['+', '-', '*', '/'];
            return operators[Math.floor(Math.random() * operators.length)];
        }

        // ç”Ÿæˆé™¤æ³•é¢˜ç›®ï¼ˆå…è®¸å°æ•°ç»“æœï¼‰
        function generateDivisionProblem() {
            // ä½¿ç”¨è¾ƒå°çš„æ•°å­—ç¡®ä¿æ˜“äºè®¡ç®—
            const divisors = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
            const dividends = [10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100];
            
            let dividend = dividends[Math.floor(Math.random() * dividends.length)];
            let divisor = divisors[Math.floor(Math.random() * divisors.length)];
            
            // è®¡ç®—ç»“æœå¹¶ä¿ç•™ä¸€ä½å°æ•°
            let answer = parseFloat((dividend / divisor).toFixed(1));
            
            return {
                num1: dividend,
                operator: '/',
                num2: divisor,
                answer: answer
            };
        }

        // ç”Ÿæˆé¢˜ç›®
        function generateProblem() {
            const operator = getRandomOperator();
            
            if (operator === '/') {
                return generateDivisionProblem();
            } else if (operator === '*' || operator === '+' || operator === '-') {
                // å¯¹äºä¹˜æ³•ï¼Œé™åˆ¶æ•°å­—åœ¨12ä»¥å†…ä»¥æ–¹ä¾¿è®¡ç®—
                // å¯¹äºåŠ å‡æ³•ï¼Œä¿æŒ1000ä»¥å†…
                let num1, num2, answer;
                
                if (operator === '*') {
                    // ä½¿ç”¨è¾ƒå°çš„æ•°å­—ç¡®ä¿æ˜“äºè®¡ç®—
                    const multiplicands = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
                    num1 = multiplicands[Math.floor(Math.random() * multiplicands.length)];
                    num2 = multiplicands[Math.floor(Math.random() * multiplicands.length)];
                    answer = num1 * num2;
                } else {
                    num1 = getRandomInt(1, 1000);
                    num2 = getRandomInt(1, 1000);
                    if (operator === '+') {
                        answer = num1 + num2;
                    } else {
                        answer = num1 - num2;
                        // ç¡®ä¿å‡æ³•ç»“æœä¸ä¸ºè´Ÿæ•°
                        if (answer < 0) {
                            // äº¤æ¢æ•°å€¼
                            let temp = num1;
                            num1 = num2;
                            num2 = temp;
                            answer = num1 - num2;
                        }
                    }
                }
                
                return {
                    num1: num1,
                    operator: operator,
                    num2: num2,
                    answer: answer
                };
            }
        }

        // æ˜¾ç¤ºé¢˜ç›®
        function displayProblems() {
            const problemsContainer = document.getElementById('problems');
            problemsContainer.innerHTML = '';
            
            for (let i = 1; i <= 10; i++) {
                const problem = generateProblem();
                const problemDiv = document.createElement('div');
                problemDiv.className = 'problem';
                problemDiv.innerHTML = `
                    <div class="problem-number">${i}.</div>
                    <div class="problem-expression">${problem.num1} ${problem.operator} ${problem.num2} =</div>
                    <input type="number" class="answer-input" id="answer${i}" data-correct="${problem.answer}" step="0.1">
                `;
                problemsContainer.appendChild(problemDiv);
            }
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswers() {
            let correctCount = 0;
            let wrongCount = 0;
            
            for (let i = 1; i <= 10; i++) {
                const input = document.getElementById(`answer${i}`);
                const userAnswer = parseFloat(input.value) || 0;
                const correctAnswer = parseFloat(input.dataset.correct);
                
                // å¯¹äºé™¤æ³•é—®é¢˜ï¼Œå…è®¸å°æ•°ç‚¹åä¸€ä½çš„è¯¯å·®
                if (Math.abs(userAnswer - correctAnswer) < 0.05) {
                    correctCount++;
                    input.style.borderColor = '#4CAF50';
                } else {
                    wrongCount++;
                    input.style.borderColor = '#f44336';
                }
            }
            
            showResult(correctCount, wrongCount);
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(correctCount, wrongCount) {
            const resultContainer = document.getElementById('result');
            resultContainer.style.display = 'block';
            
            if (correctCount === 10) {
                resultContainer.className = 'result-container perfect-score';
                resultContainer.innerHTML = `
                    <h2>å¤ªæ£’äº†ï¼å…¨å¯¹ï¼ğŸ‰</h2>
                    <p>ä½ ç­”å¯¹äº†å…¨éƒ¨10é“é¢˜ï¼</p>
                `;
                startFireworks();
            } else if (wrongCount >= 2) {
                resultContainer.className = 'result-container needs-practice';
                resultContainer.innerHTML = `
                    <h2>ç»§ç»­åŠªåŠ›ï¼ğŸ’ª</h2>
                    <p>ä½ ç­”å¯¹äº†${correctCount}é“é¢˜ï¼Œé”™äº†${wrongCount}é“é¢˜ã€‚</p>
                    <p>ä¸è¦ç°å¿ƒï¼Œå¤šç»ƒä¹ å°±ä¼šè¿›æ­¥çš„ï¼</p>
                `;
            } else {
                resultContainer.className = 'result-container';
                resultContainer.innerHTML = `
                    <h2>ä¸é”™ï¼</h2>
                    <p>ä½ ç­”å¯¹äº†${correctCount}é“é¢˜ï¼Œé”™äº†${wrongCount}é“é¢˜ã€‚</p>
                    <p>å†ä»”ç»†ä¸€ç‚¹å°±æ›´å¥½äº†ï¼</p>
                `;
            }
        }

        // çƒŸèŠ±æ•ˆæœ
        function startFireworks() {
            const canvas = document.getElementById('fireworksCanvas');
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®ç”»å¸ƒå¤§å°
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // çƒŸèŠ±ç²’å­æ•°ç»„
            const particles = [];
            
            // åˆ›å»ºçƒŸèŠ±ç²’å­
            function createParticle(x, y) {
                const particleCount = 100;
                for (let i = 0; i < particleCount; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        radius: Math.random() * 2 + 1,
                        color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                        velocity: {
                            x: (Math.random() - 0.5) * 10,
                            y: (Math.random() - 0.5) * 10
                        },
                        alpha: 1,
                        decay: Math.random() * 0.03 + 0.01
                    });
                }
            }
            
            // æ›´æ–°å’Œç»˜åˆ¶ç²’å­
            function updateParticles() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];
                    
                    // æ›´æ–°ä½ç½®
                    p.x += p.velocity.x;
                    p.y += p.velocity.y;
                    
                    // æ·»åŠ é‡åŠ›
                    p.velocity.y += 0.1;
                    
                    // æ›´æ–°é€æ˜åº¦
                    p.alpha -= p.decay;
                    
                    // ç»˜åˆ¶ç²’å­
                    ctx.globalAlpha = p.alpha;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                    ctx.fillStyle = p.color;
                    ctx.fill();
                    
                    // ç§»é™¤æ¶ˆå¤±çš„ç²’å­
                    if (p.alpha <= 0) {
                        particles.splice(i, 1);
                        i--;
                    }
                }
                
                // ç»§ç»­åŠ¨ç”»
                if (particles.length > 0) {
                    requestAnimationFrame(updateParticles);
                }
            }
            
            // å¯åŠ¨çƒŸèŠ±
            function launchFirework() {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height / 2;
                createParticle(x, y);
                
                if (particles.length > 0) {
                    updateParticles();
                }
            }
            
            // å®šæ—¶å¯åŠ¨å¤šä¸ªçƒŸèŠ±
            const fireworksInterval = setInterval(() => {
                launchFirework();
            }, 300);
            
            // 5ç§’ååœæ­¢çƒŸèŠ±
            setTimeout(() => {
                clearInterval(fireworksInterval);
            }, 5000);
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            displayProblems();
        };
    </script>
</body>
</html>
